{% extends 'base.html.twig' %}

{% block title %}Administration - KickScore{% endblock %}

{% block body %}
    <div class="bg-gradient-to-br from-slate-50 to-white min-h-screen">
        <div class="max-w-7xl mx-auto px-4 py-6 sm:px-6 lg:px-8">
            <h1 class="text-3xl sm:text-4xl font-bold text-slate-800 text-center mb-8">
                {{ championship.name }}
                <span class="block mt-2 text-lg sm:text-2xl text-blue-900 font-medium" id="subtitle">
                    {{ 'manageuserchamp' | trans }}
                </span>
            </h1>

            {# flash #}
            {% for message in app.flashes('success') %}
                <div class="bg-green-50 border border-green-200 text-green-800 rounded-lg p-4 mb-6">
                    <p class="text-sm font-medium">{{ message }}</p>
                </div>
            {% endfor %}
            {% for message in app.flashes('error') %}
                <div class="bg-red-50 border border-red-200 text-red-800 rounded-lg p-4 mb-6">
                    <p class="text-sm font-medium">{{ message }}</p>
                </div>
            {% endfor %}

            <!-- tabs -->
            <nav class="w-full border-b border-slate-200 mb-6 overflow-y-hidden overflow-x-auto sticky top-0 bg-white z-10">
                <div class="flex justify-center min-w-max mx-auto">
                    <div class="flex min-w-max">
                        <button id="tab_infos"
                                class="px-4 sm:px-6 py-2 sm:py-3 text-sm font-medium border-b-2 border-transparent hover:border-slate-300 hover:text-slate-600 transition-colors relative sm:-mb-[2px] rounded-t-lg sm:rounded-none">
                            <span class="flex items-center justify-center gap-2">
                                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor"
                                     class="bi bi-info-circle-fill" viewBox="0 0 16 16">
                                    <path d="M8 16A8 8 0 1 0 8 0a8 8 0 0 0 0 16m.93-9.412-1 4.705c-.07.34.029.533.304.533.194 0 .487-.07.686-.246l-.088.416c-.287.346-.92.598-1.465.598-.703 0-1.002-.422-.808-1.319l.738-3.468c.064-.293.006-.399-.287-.47l-.451-.081.082-.381 2.29-.287zM8 5.5a1 1 0 1 1 0-2 1 1 0 0 1 0 2"/>
                                </svg>
                                {{ 'infos' | trans }}
                            </span>
                        </button>
                        <button id="tab_fields"
                                class="px-4 sm:px-6 py-2 sm:py-3 text-sm font-medium border-b-2 border-transparent hover:border-slate-300 hover:text-slate-600 transition-colors relative sm:-mb-[2px] rounded-t-lg sm:rounded-none">
                            <span class="flex items-center justify-center gap-2">
                                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor"
                                     class="bi bi-geo" viewBox="0 0 16 16">
                                  <path fill-rule="evenodd"
                                        d="M8 1a3 3 0 1 0 0 6 3 3 0 0 0 0-6M4 4a4 4 0 1 1 4.5 3.969V13.5a.5.5 0 0 1-1 0V7.97A4 4 0 0 1 4 3.999zm2.493 8.574a.5.5 0 0 1-.411.575c-.712.118-1.28.295-1.655.493a1.3 1.3 0 0 0-.37.265.3.3 0 0 0-.057.09V14l.002.008.016.033a.6.6 0 0 0 .145.15c.165.13.435.27.813.395.751.25 1.82.414 3.024.414s2.273-.163 3.024-.414c.378-.126.648-.265.813-.395a.6.6 0 0 0 .146-.15l.015-.033L12 14v-.004a.3.3 0 0 0-.057-.09 1.3 1.3 0 0 0-.37-.264c-.376-.198-.943-.375-1.655-.493a.5.5 0 1 1 .164-.986c.77.127 1.452.328 1.957.594C12.5 13 13 13.4 13 14c0 .426-.26.752-.544.977-.29.228-.68.413-1.116.558-.878.293-2.059.465-3.34.465s-2.462-.172-3.34-.465c-.436-.145-.826-.33-1.116-.558C3.26 14.752 3 14.426 3 14c0-.599.5-1 .961-1.243.505-.266 1.187-.467 1.957-.594a.5.5 0 0 1 .575.411"/>
                                </svg>
                                {{ 'field' | trans }}
                            </span>
                        </button>
                        <button id="tab_teams"
                                class="px-4 sm:px-6 py-2 sm:py-3 text-sm font-medium border-b-2 border-transparent hover:border-slate-300 hover:text-slate-600 transition-colors relative sm:-mb-[2px] rounded-t-lg sm:rounded-none">
                            <span class="flex items-center justify-center gap-2">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20"
                                     fill="currentColor">
                                    <path d="M13 6a3 3 0 11-6 0 3 3 0 016 0zM18 8a2 2 0 11-4 0 2 2 0 014 0zM14 15a4 4 0 00-8 0v3h8v-3zM6 8a2 2 0 11-4 0 2 2 0 014 0zM16 18v-3a5.972 5.972 0 00-.75-2.906A3.005 3.005 0 0119 15v3h-3zM4.75 12.094A5.973 5.973 0 004 15v3H1v-3a3 3 0 013.75-2.906z"/>
                                </svg>
                                {{ 'team_label' | trans }}
                            </span>
                        </button>
                        <button id="tab_matches"
                                class="px-4 sm:px-6 py-2 sm:py-3 text-sm font-medium border-b-2 border-transparent hover:border-slate-300 hover:text-slate-600 transition-colors relative sm:-mb-[2px] rounded-t-lg sm:rounded-none">
                                <span class="flex items-center justify-center gap-2">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor"
                                         class="bi bi-trophy" viewBox="0 0 16 16">
                                        <path d="M2.5.5A.5.5 0 0 1 3 0h10a.5.5 0 0 1 .5.5c0 .538-.012 1.05-.034 1.536a3 3 0 1 1-1.133 5.89c-.79 1.865-1.878 2.777-2.833 3.011v2.173l1.425.356c.194.048.377.135.537.255L13.3 15.1a.5.5 0 0 1-.3.9H3a.5.5 0 0 1-.3-.9l1.838-1.379c.16-.12.343-.207.537-.255L6.5 13.11v-2.173c-.955-.234-2.043-1.146-2.833-3.012a3 3 0 1 1-1.132-5.89A33.076 33.076 0 0 1 2.5.5zm.099 2.54a2 2 0 0 0 .72 3.935c-.333-1.05-.588-2.346-.72-3.935zm10.083 3.935a2 2 0 0 0 .72-3.935c-.133 1.59-.388 2.885-.72 3.935z"/>
                                    </svg>
                                    {{ 'matches' | trans }}
                                </span>
                        </button>
                    </div>
                </div>
            </nav>

            <!-- infos -->
            <div id="panel_infos" class="hidden">
                <div class="bg-white rounded-lg shadow-sm border border-slate-200">
                    <div class="flex flex-col sm:flex-row sm:justify-between sm:items-center gap-4 p-6 border-b border-slate-200">
                        <div class="flex-1">
                            <h2 class="text-xl font-bold text-slate-800">
                                {{ championship.name }}
                            </h2>
                        </div>
                    </div>
                    <div class="flex flex-col sm:flex-row sm:justify-between sm:items-center gap-4 p-6 border-b border-slate-200">

                        <div class="overflow-x-auto">
                            <div class="inline-block min-w-full">
                                <div class="overflow-hidden space-y-2">
                                <span class="block text-sm text-slate-600 font-normal">
                                    <strong>{{ 'creator' | trans }}:</strong> {{ championship.organizer.getName() }}
                                </span>
                                    <span class="block text-sm text-slate-600 font-normal">
                                    <strong>{{ 'description' | trans }}:</strong> {{ championship.getDescription() }}
                                </span>
                                    <span class="block text-sm text-slate-600 font-normal">
                                    <strong>{{ 'start_date' | trans }}:</strong> {{ championship.startDate|date('Y-m-d H:i:s') }}
                                </span>
                                    <span class="block text-sm text-slate-600 font-normal">
                                    <strong>{{ 'end_date' | trans }}:</strong> {{ championship.endDate|date('Y-m-d H:i:s') }}
                                </span>
                                    <span class="block text-sm text-slate-600 font-normal">
                                    <strong>{{ 'accepted_timeslots' | trans }}:</strong>
                                </span>
                                </div>
                            </div>
                        </div>
                    </div>

                </div>
            </div>

            <!-- fields -->
            <div id="panel_fields" class="hidden">
                <div class="bg-white rounded-lg shadow-sm border border-slate-200 overflow-x-auto">
                    <div class="flex flex-col md:flex-row md:justify-between md:items-center gap-4 p-6 border-b border-slate-200">
                        <h2 class="text-xl font-bold text-slate-800">
                            {{ 'field_list.title' | trans }}
                            <span class="block mt-1 text-sm text-slate-600 font-normal">
                    {{ 'field_list.subtitle' | trans }}
                </span>
                        </h2>

                        <div class="relative w-full sm:w-64">
                            <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                                <svg class="h-5 w-5 text-slate-400" viewBox="0 0 20 20" fill="currentColor">
                                    <path fill-rule="evenodd"
                                          d="M8 4a4 4 0 100 8 4 4 0 000-8zM2 8a6 6 0 1110.89 3.476l4.817 4.817a1 1 0 01-1.414 1.414l-4.816-4.816A6 6 0 012 8z"
                                          clip-rule="evenodd"/>
                                </svg>
                            </div>
                            <input type="text"
                                   id="fieldSearch"
                                   class="w-full pl-10 pr-4 py-2 border border-slate-200 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm"
                                   placeholder="{{ 'search'|trans }}">
                        </div>

                        <button type="button"
                                onclick="toggleFieldModal()"
                                class="inline-flex items-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-900 hover:bg-blue-800 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-700 transition-colors">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" viewBox="0 0 20 20"
                                 fill="currentColor">
                                <path fill-rule="evenodd"
                                      d="M10 3a1 1 0 011 1v5h5a1 1 0 110 2h-5v5a1 1 0 11-2 0v-5H4a1 1 0 110-2h5V4a1 1 0 011-1z"
                                      clip-rule="evenodd"/>
                            </svg>
                            {{ "create_field"|trans }}
                        </button>
                    </div>

                    <!-- creation modal -->
                    <div id="fieldModal" class="fixed inset-0 hidden z-50">
                        <!-- overlay -->
                        <div class="absolute inset-0 bg-black bg-opacity-50 backdrop-blur-sm"
                             onclick="window.toggleFieldModal()"></div>

                        <!-- content -->
                        <div class="fixed inset-0 z-50 overflow-y-auto">
                            <div class="flex min-h-full items-center justify-center p-4">
                                <div class="relative w-full max-w-md transform overflow-hidden rounded-xl bg-white shadow-2xl transition-all">
                                    <!-- head -->
                                    <div class="flex items-center justify-between border-b border-gray-200 p-4">
                                        <h3 class="text-xl font-bold text-slate-800">
                                            {{ "create_field"|trans }}
                                            <span class="block mt-1 text-blue-900 text-lg font-medium">
                                                {{ "field_creation"|trans }}
                                            </span>
                                        </h3>
                                        <button type="button"
                                                onclick="window.toggleFieldModal()"
                                                class="rounded-md p-1 text-gray-400 hover:text-gray-500 hover:bg-gray-100 transition-colors">
                                            <span class="sr-only">Close</span>
                                            <svg class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke-width="2"
                                                 stroke="currentColor">
                                                <path stroke-linecap="round" stroke-linejoin="round"
                                                      d="M6 18L18 6M6 6l12 12"/>
                                            </svg>
                                        </button>
                                    </div>

                                    <!-- body -->
                                    <div class="p-6">
                                        <form method="post" action="{{ path('app_field_create') }}" class="space-y-6">
                                            <input type="hidden" name="championship" value="{{ championship.id }}">

                                            <div class="space-y-1">
                                                <label for="name" class="text-sm font-medium text-slate-700">
                                                    {{ 'namefield' | trans }}
                                                </label>
                                                <input type="text"
                                                       id="name"
                                                       name="name"
                                                       required
                                                       class="w-full px-4 py-3 rounded-lg border border-slate-200 focus:ring-2 focus:ring-blue-900 focus:border-blue-900 transition-colors"
                                                       placeholder="{{ 'insertfieldname' | trans }}">
                                            </div>

                                            <!-- footer -->
                                            <div class="mt-6 flex items-center justify-end gap-3">
                                                <button type="button"
                                                        onclick="window.toggleFieldModal()"
                                                        class="inline-flex items-center px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-900 transition-colors">
                                                    {{ "cancel"|trans }}
                                                </button>
                                                <button type="submit"
                                                        class="inline-flex items-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-900 hover:bg-blue-800 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-900 transition-colors">
                                                    {{ "create_field"|trans }}
                                                </button>
                                            </div>
                                        </form>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <!-- delete confirm modal -->
                    <div id="confirmDeleteFieldModal" class="fixed inset-0 hidden z-50">
                        <!-- overlay -->
                        <div class="absolute inset-0 bg-black bg-opacity-50 backdrop-blur-sm"></div>

                        <!-- content -->
                        <div class="fixed inset-0 z-50 overflow-y-auto">
                            <div class="flex min-h-full items-center justify-center p-4">
                                <div class="relative w-full max-w-md transform overflow-hidden rounded-xl bg-white shadow-2xl transition-all">
                                    <!-- head -->
                                    <div class="flex items-center justify-between border-b border-gray-200 p-4">
                                        <h3 class="text-xl font-bold text-slate-800">
                                            {{ 'confirm_delete.title'|trans }}
                                        </h3>
                                        <button type="button"
                                                onclick="toggleDeleteFieldModal()"
                                                class="rounded-md p-1 text-gray-400 hover:text-gray-500 hover:bg-gray-100 transition-colors">
                                            <span class="sr-only">Close</span>
                                            <svg class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke-width="2"
                                                 stroke="currentColor">
                                                <path stroke-linecap="round" stroke-linejoin="round"
                                                      d="M6 18L18 6M6 6l12 12"/>
                                            </svg>
                                        </button>
                                    </div>

                                    <!-- body -->
                                    <div class="p-6">
                                        <p class="text-sm text-slate-600">
                                            {{ "confirm_delete.field"|trans }}
                                        </p>

                                        <!-- footer -->
                                        <div class="mt-6 flex items-center justify-end gap-3">
                                            <button type="button"
                                                    onclick="toggleDeleteFieldModal()"
                                                    class="inline-flex items-center px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-900 transition-colors">
                                                {{ "cancel"|trans }}
                                            </button>
                                            <button type="button"
                                                    id="confirmDeleteButton"
                                                    class="inline-flex items-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-red-600 hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500 transition-colors">
                                                {{ "delete"|trans }}
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <!-- fields table -->
                    <table class="w-full">
                        <thead class="bg-slate-50 border-b border-slate-200">
                        <tr>
                            <th scope="col"
                                class="px-3 sm:px-6 py-3 text-left text-xs font-medium text-slate-700 uppercase tracking-wider">
                                {{ 'name' | trans }}
                            </th>
                            <th scope="col"
                                class="px-3 sm:px-6 py-3 text-left text-xs font-medium text-slate-700 uppercase tracking-wider">
                                {{ 'field Championship' | trans }}
                            </th>
                            <th scope="col"
                                class="px-3 sm:px-6 py-3 text-right text-xs font-medium text-slate-700 uppercase tracking-wider">
                                {{ 'user_list.table.actions' | trans }}
                            </th>
                        </tr>
                        </thead>
                        <tbody class="divide-y divide-slate-200">
                        {% if fields is empty %}
                            <tr>
                                <td colspan="3" class="px-4 sm:px-6 py-4 text-center text-sm text-slate-500">
                                    {{ 'No fields found' }}
                                </td>
                            </tr>
                        {% else %}
                            {% for field in fields %}
                                <tr class="hover:bg-slate-50 transition-colors">
                                    <td class="px-4 sm:px-6 py-3 sm:py-4">
                                        <div class="flex items-center">
                                            <span class="text-xs sm:text-sm text-slate-600">{{ field.name }}</span>
                                        </div>
                                    </td>
                                    <td class="px-4 sm:px-6 py-3 sm:py-4">
                                        {% if field.championship %}
                                            <span class="text-xs sm:text-sm text-slate-600">{{ field.championship.name }}</span>
                                        {% else %}
                                            <span class="text-xs sm:text-sm text-slate-400">-</span>
                                        {% endif %}
                                    </td>
                                    <td class="px-4 sm:px-6 py-3 sm:py-4 text-xs sm:text-sm whitespace-nowrap">
                                        <div class="flex items-center justify-end space-x-2">
                                            <form method="post"
                                                  action="{{ path('app_delete_field', {'id': field.id}) }}"
                                                  onsubmit="return false;"
                                                  id="delete-form-{{ field.id }}">
                                                <input type="hidden" name="_token"
                                                       value="{{ csrf_token('delete' ~ field.id) }}">
                                                <button type="button"
                                                        onclick="showDeleteConfirmation({{ field.id }})"
                                                        class="px-4 py-2 bg-red-100 text-red-700 rounded-lg hover:bg-red-200 transition-colors font-medium inline-flex items-center">
                                                    <svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor"
                                                         viewBox="0 0 24 24">
                                                        <path stroke-linecap="round" stroke-linejoin="round"
                                                              stroke-width="2"
                                                              d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"/>
                                                    </svg>
                                                    {{ 'delete' | trans }}
                                                </button>
                                            </form>

                                        </div>
                                    </td>
                                </tr>
                            {% endfor %}
                        {% endif %}
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- teams -->
            <div id="panel_teams">
                <div class="bg-white rounded-lg shadow-sm border border-slate-200">
                    <div class="flex flex-col sm:flex-row sm:justify-between sm:items-center gap-4 p-6 border-b border-slate-200">
                        <h2 class="text-xl font-bold text-slate-800">
                            {{ 'teamlist' | trans }}
                            <span class="block mt-1 text-sm text-slate-600 font-normal">
                    {{ 'manageteamactive' | trans }}
                </span>
                        </h2>

                        <div class="relative w-full sm:w-64">
                            <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                                <svg class="h-5 w-5 text-slate-400" viewBox="0 0 20 20" fill="currentColor">
                                    <path fill-rule="evenodd"
                                          d="M8 4a4 4 0 100 8 4 4 0 000-8zM2 8a6 6 0 1110.89 3.476l4.817 4.817a1 1 0 01-1.414 1.414l-4.816-4.816A6 6 0 012 8z"
                                          clip-rule="evenodd"/>
                                </svg>
                            </div>
                            <input type="text"
                                   id="teamSearch"
                                   class="w-full pl-10 pr-4 py-2 border border-slate-200 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm"
                                   placeholder="{{ 'search'|trans }}">
                        </div>
                    </div>

                    <div class="sm:hidden divide-y divide-slate-200">
                        {% for team in teams %}
                            <div class="p-4 space-y-3">
                                <div class="flex justify-between items-start">
                                    <div>
                                        <h3 class="font-medium text-slate-900">{{ team.name }}</h3>
                                        <span class="inline-flex items-center px-2 py-1 mt-1 text-xs font-medium rounded-full bg-blue-100 text-blue-800">
                                <svg class="w-3 h-3 mr-1" viewBox="0 0 20 20" fill="currentColor">
                                    <path d="M10 9a3 3 0 100-6 3 3 0 000 6zm-7 9a7 7 0 1114 0H3z"/>
                                </svg>
                                {{ team.members|length }} {{ 'members'|trans }}
                            </span>
                                    </div>
                                    <a href="{{ path('app_team_edit', {'id': team.id}) }}"
                                       class="inline-flex items-center px-3 py-1.5 bg-blue-900 text-white text-xs rounded-lg hover:bg-blue-800 transition-colors font-medium shadow-sm">
                                        <svg class="w-4 h-4 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                                  d="M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z"/>
                                        </svg>
                                        {{ 'manage'|trans }}
                                    </a>
                                </div>
                            </div>
                        {% else %}
                            <div class="p-8 text-center text-slate-500">
                                <svg class="mx-auto h-12 w-12 text-slate-400" fill="none" viewBox="0 0 24 24"
                                     stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                          d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"/>
                                </svg>
                                <p class="mt-2 text-sm font-medium">{{ 'noteamfound'|trans }}</p>
                            </div>
                        {% endfor %}
                    </div>

                    <div class="hidden sm:block overflow-x-auto">
                        <table class="w-full">
                            <thead class="bg-slate-50 border-b border-slate-200">
                            <tr>
                                <th scope="col"
                                    class="px-6 py-3 text-left text-xs font-medium text-slate-700 uppercase tracking-wider">
                                    {{ 'team_creation.name.placeholder'|trans }}
                                </th>
                                <th scope="col"
                                    class="px-6 py-3 text-left text-xs font-medium text-slate-700 uppercase tracking-wider">
                                    {{ 'member'|trans }}
                                </th>
                                <th scope="col"
                                    class="px-6 py-3 text-right text-xs font-medium text-slate-700 uppercase tracking-wider">
                                    {{ 'user_list.table.actions'|trans }}
                                </th>
                            </tr>
                            </thead>
                            <tbody class="divide-y divide-slate-200">
                            {% for team in teams %}
                                <tr class="hover:bg-slate-50 transition-colors">
                                    <td class="px-6 py-4 whitespace-nowrap">
                                        <div class="text-sm font-medium text-slate-900">{{ team.name }}</div>
                                    </td>
                                    <td class="px-6 py-4 whitespace-nowrap">
                                <span class="inline-flex items-center px-2.5 py-1 rounded-full text-xs font-medium bg-blue-100 text-blue-800">
                                    <svg class="w-3 h-3 mr-1.5" viewBox="0 0 20 20" fill="currentColor">
                                        <path d="M10 9a3 3 0 100-6 3 3 0 000 6zm-7 9a7 7 0 1114 0H3z"/>
                                    </svg>
                                    {{ team.members|length }}
                                </span>
                                    </td>
                                    <td class="px-6 py-4 whitespace-nowrap text-right text-sm font-medium">
                                        <a href="{{ path('app_team_edit', {'id': team.id}) }}"
                                           class="inline-flex items-center px-3 py-1.5 bg-blue-900 text-white rounded-lg hover:bg-blue-800 transition-colors font-medium shadow-sm">
                                            <svg class="w-4 h-4 mr-1.5" fill="none" stroke="currentColor"
                                                 viewBox="0 0 24 24">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                                      d="M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z"/>
                                            </svg>
                                            {{ 'manage'|trans }}
                                        </a>
                                    </td>
                                </tr>
                            {% else %}
                                <tr>
                                    <td colspan="3" class="px-6 py-8 text-center text-sm text-slate-500">
                                        <svg class="mx-auto h-12 w-12 text-slate-400" fill="none" viewBox="0 0 24 24"
                                             stroke="currentColor">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                                  d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"/>
                                        </svg>
                                        <p class="mt-2 font-medium">{{ 'noteamfound'|trans }}</p>
                                    </td>
                                </tr>
                            {% endfor %}
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- matches -->
            <div id="panel_matches" class="hidden">
                <div class="bg-white rounded-lg shadow-sm border border-slate-200">
                    <div class="flex flex-col sm:flex-row sm:justify-between sm:items-center gap-4 p-6 border-b border-slate-200">
                        <h2 class="text-xl font-bold text-slate-800">
                            {{ 'matchlist' | trans }}
                            <span class="block mt-1 text-sm text-slate-600 font-normal">
                    {{ 'nav.manage_matches' | trans }}
                </span>
                        </h2>

                        <div class="relative w-full sm:w-64">
                            <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                                <svg class="h-5 w-5 text-slate-400" viewBox="0 0 20 20" fill="currentColor">
                                    <path fill-rule="evenodd"
                                          d="M8 4a4 4 0 100 8 4 4 0 000-8zM2 8a6 6 0 1110.89 3.476l4.817 4.817a1 1 0 01-1.414 1.414l-4.816-4.816A6 6 0 012 8z"
                                          clip-rule="evenodd"/>
                                </svg>
                            </div>
                            <input type="text"
                                   id="matchSearch"
                                   class="w-full pl-10 pr-4 py-2 border border-slate-200 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm"
                                   placeholder="{{ 'search'|trans }}">
                        </div>
                    </div>

                    <div class="sm:hidden divide-y divide-slate-200">
                        {% for match in matches %}
                            <div class="p-4 space-y-3">
                                <div class="flex justify-between items-start">
                                    <div>
                                        <div class="text-sm font-medium text-slate-900">
                                            {{ match.date|date('d/m/Y H:i') }}
                                        </div>
                                        <div class="mt-2">
                                            <div class="text-sm font-bold text-green-700">{{ match.blueTeam.name }}</div>
                                            <div class="text-xs text-slate-500 my-1">vs</div>
                                            <div class="text-sm font-bold text-blue-700">{{ match.greenTeam.name }}</div>
                                        </div>
                                        <div class="mt-2 text-xs text-slate-600">
                                            {{ match.field.name }}
                                        </div>
                                    </div>
                                    <div class="text-center">
                                        {% if match.greenScore is not null and match.blueScore is not null %}
                                            <div class="text-lg font-bold text-slate-900">
                                                {{ match.greenScore }} - {{ match.blueScore }}
                                            </div>
                                        {% else %}
                                            <span class="text-sm text-slate-500">-</span>
                                        {% endif %}
                                    </div>
                                </div>
                                <div class="flex justify-end">
                                    <a href="{{ path('edit_match', {'id': match.id}) }}"
                                       class="inline-flex items-center px-3 py-1.5 bg-blue-900 text-white text-xs rounded-lg hover:bg-blue-800 transition-colors font-medium shadow-sm">
                                        <svg class="w-4 h-4 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path d="M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z"/>
                                        </svg>
                                        {{ 'edit'|trans }}
                                    </a>
                                </div>
                            </div>
                        {% else %}
                            <div class="p-8 text-center text-slate-500">
                                <svg class="mx-auto h-12 w-12 text-slate-400" fill="none" viewBox="0 0 24 24"
                                     stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                          d="M19 20H5a2 2 0 01-2-2V6a2 2 0 012-2h10a2 2 0 012 2v1m2 13a2 2 0 01-2-2V7m2 13a2 2 0 002-2V9a2 2 0 00-2-2h-2m-4-3H9M7 16h6M7 8h6v4H7V8z"/>
                                </svg>
                                <p class="mt-2 text-sm font-medium">{{ 'no_matches'|trans }}</p>
                            </div>
                        {% endfor %}
                    </div>

                    <div class="hidden sm:block overflow-x-auto">
                        <table class="w-full">
                            <thead class="bg-slate-50 border-b border-slate-200">
                            <tr>
                                <th class="px-6 py-3 text-left text-xs font-medium text-slate-700 uppercase tracking-wider">
                                    {{ 'teams'|trans }}
                                </th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-slate-700 uppercase tracking-wider">
                                    {{ 'date'|trans }}
                                </th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-slate-700 uppercase tracking-wider">
                                    {{ 'field'|trans }}
                                </th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-slate-700 uppercase tracking-wider">
                                    {{ 'score'|trans }}
                                </th>
                                <th class="px-6 py-3 text-right text-xs font-medium text-slate-700 uppercase tracking-wider">
                                    {{ 'actions'|trans }}
                                </th>
                            </tr>
                            </thead>
                            <tbody class="divide-y divide-slate-200" id="matchesTableBody">
                            {% for match in matches %}
                                <tr class="hover:bg-slate-50 transition-colors match-row">
                                    <td class="px-6 py-4">
                                        <div class="flex flex-col">
                                            <span class="text-sm font-bold text-green-700">{{ match.blueTeam.name }}</span>
                                            <span class="text-xs text-slate-500 my-1">vs</span>
                                            <span class="text-sm font-bold text-blue-700">{{ match.greenTeam.name }}</span>
                                        </div>
                                    </td>
                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-slate-900">
                                        {{ match.date|date('d/m/Y H:i') }}
                                    </td>
                                    <td class="px-6 py-4 text-sm text-slate-900">
                                        {{ match.field.name }}
                                    </td>
                                    <td class="px-6 py-4 whitespace-nowrap">
                                        {% if match.greenScore is not null and match.blueScore is not null %}
                                            <span class="text-sm font-medium text-slate-900">
                                        {{ match.greenScore }} - {{ match.blueScore }}
                                    </span>
                                        {% else %}
                                            <span class="text-sm text-slate-500">-</span>
                                        {% endif %}
                                    </td>
                                    <td class="px-6 py-4 text-right">
                                        <a href="{{ path('edit_match', {'id': match.id}) }}"
                                           class="inline-flex items-center px-3 py-1.5 bg-blue-900 text-white text-xs rounded-lg hover:bg-blue-800 transition-colors font-medium shadow-sm">
                                            <svg class="w-4 h-4 mr-1.5" fill="none" stroke="currentColor"
                                                 viewBox="0 0 24 24">
                                                <path d="M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z"/>
                                            </svg>
                                            {{ 'edit'|trans }}
                                        </a>
                                    </td>
                                </tr>
                            {% endfor %}
                            </tbody>
                        </table>
                    </div>

                    <div class="px-6 py-4 bg-white border-t border-slate-200">
                        <div class="flex items-center justify-between">
                            <div class="flex items-center gap-2">
                                <button id="prevPage"
                                        class="px-3 py-1 border border-slate-200 rounded-lg hover:bg-slate-50 disabled:opacity-50 disabled:cursor-not-allowed">
                                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                              d="M15 19l-7-7 7-7"/>
                                    </svg>
                                </button>
                                <div id="pagination" class="flex items-center gap-1">
                                </div>
                                <button id="nextPage"
                                        class="px-3 py-1 border border-slate-200 rounded-lg hover:bg-slate-50 disabled:opacity-50 disabled:cursor-not-allowed">
                                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                              d="M9 5l7 7-7 7"/>
                                    </svg>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

        </div>
    </div>

    <script>
        function showDeleteConfirmation(fieldId) {
            currentFieldId = fieldId;
            const modal = document.getElementById('confirmDeleteFieldModal');
            modal.classList.remove('hidden');
            document.body.style.overflow = 'hidden';
        }

        function toggleDeleteFieldModal() {
            const modal = document.getElementById('confirmDeleteFieldModal');
            modal.classList.add('hidden');
            document.body.style.overflow = 'auto';
            currentFieldId = null;
        }

        function toggleFieldModal() {
            const modal = document.getElementById('fieldModal');
            if (modal.classList.contains('hidden')) {
                modal.classList.remove('hidden');
                document.body.style.overflow = 'hidden';
            } else {
                modal.classList.add('hidden');
                document.body.style.overflow = 'auto';
            }
        }

        document.addEventListener('DOMContentLoaded', function () {
            console.log('Script initialized');

            initializeSearch('teamSearch', '{{ path('api_teams_search') }}');
            initializeSearch('fieldSearch', '{{ path('api_fields_search') }}');
            initializeSearch('matchSearch', '{{ path('api_search_match') }}');

            document.getElementById('confirmDeleteButton').addEventListener('click', function () {
                if (currentFieldId) {
                    document.getElementById(`delete-form-${currentFieldId}`).submit();
                }
            });

            document.addEventListener('keydown', function (event) {
                if (event.key === 'Escape') {
                    const deleteModal = document.getElementById('confirmDeleteFieldModal');
                    if (!deleteModal.classList.contains('hidden')) {
                        toggleDeleteFieldModal();
                    }
                }
            });

            const MATCHES_PER_PAGE = 5;
            let currentPage = 1;
            let matchRows = Array.from(document.querySelectorAll('.match-row'));

            function updatePagination() {
                const totalPages = Math.ceil(matchRows.length / MATCHES_PER_PAGE);
                const paginationContainer = document.getElementById('pagination');
                const prevButton = document.getElementById('prevPage');
                const nextButton = document.getElementById('nextPage');

                paginationContainer.innerHTML = '';

                for (let i = 1; i <= totalPages; i++) {
                    const button = document.createElement('button');
                    button.textContent = i;
                    button.className = `px-3 py-1 border border-slate-200 rounded-lg hover:bg-slate-50 ${
                        currentPage === i ? 'bg-blue-50 border-blue-200 text-blue-600' : ''
                    }`;
                    button.addEventListener('click', () => {
                        currentPage = i;
                        displayMatches();
                    });
                    paginationContainer.appendChild(button);
                }

                prevButton.disabled = currentPage === 1;
                nextButton.disabled = currentPage === totalPages;
            }

            function displayMatches() {
                const start = (currentPage - 1) * MATCHES_PER_PAGE;
                const end = start + MATCHES_PER_PAGE;

                matchRows.forEach((row, index) => {
                    if (index >= start && index < end) {
                        row.style.display = '';
                    } else {
                        row.style.display = 'none';
                    }
                });

                updatePagination();
            }

            function initializeSearch(inputId, apiEndpoint) {
                const searchInput = document.getElementById(inputId);
                if (!searchInput) return;

                function debounce(func, wait) {
                    let timeout;
                    return function (...args) {
                        clearTimeout(timeout);
                        timeout = setTimeout(() => func.apply(this, args), wait);
                    };
                }

                const fetchResults = async (searchTerm) => {
                    try {
                        const response = await fetch(`${apiEndpoint}?q=${encodeURIComponent(searchTerm)}&chp={{ championship.id }}`, {
                            method: 'GET',
                            headers: {
                                'Accept': 'application/json'
                            }
                        });

                        if (!response.ok) {
                            throw new Error('Erreur aupr√®s de l\'API.');
                        }

                        const data = await response.json();
                        if (inputId === 'matchSearch') {
                            updateMatchesTable(data);
                        } else if (inputId === 'fieldSearch') {
                            updateFieldsTable(data);
                        } else if (inputId === 'teamSearch') {
                            updateTeamsTable(data);
                        }
                    } catch (error) {
                        console.error('Erreur lors de la recherche:', error);
                        return [];
                    }
                };

                const debouncedSearch = debounce(async (searchTerm) => {
                    await fetchResults(searchTerm);
                }, 300);

                searchInput.addEventListener('input', (e) => debouncedSearch(e.target.value));
            }

            function updateMatchesTable(matches) {
                const tbody = document.getElementById('matchesTableBody');
                if (!tbody) return;

                tbody.innerHTML = '';

                if (matches.length === 0) {
                    tbody.innerHTML = `
            <tr>
                <td colspan="5" class="px-6 py-8 text-center text-sm text-slate-500">
                    <svg class="mx-auto h-12 w-12 text-slate-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 20H5a2 2 0 01-2-2V6a2 2 0 012-2h10a2 2 0 012 2v1m2 13a2 2 0 01-2-2V7m2 13a2 2 0 002-2V9a2 2 0 00-2-2h-2m-4-3H9M7 16h6M7 8h6v4H7V8z" />
                    </svg>
                    <p class="mt-2 font-medium">Aucun match trouv√©</p>
                </td>
            </tr>`;
                    return;
                }

                matches.forEach(match => {
                    const row = document.createElement('tr');
                    row.className = 'hover:bg-slate-50 transition-colors match-row';

                    row.innerHTML = `
            <td class="px-6 py-4">
                <div class="flex flex-col">
                    <span class="text-sm font-bold text-green-700">${match.blueTeam.name}</span>
                    <span class="text-xs text-slate-500 my-1">vs</span>
                    <span class="text-sm font-bold text-blue-700">${match.greenTeam.name}</span>
                </div>
            </td>
            <td class="px-6 py-4 whitespace-nowrap text-sm text-slate-900">
                ${new Date(match.date).toLocaleDateString('fr-FR', {
                        day: '2-digit',
                        month: '2-digit',
                        year: 'numeric',
                        hour: '2-digit',
                        minute: '2-digit'
                    })}
            </td>
            <td class="px-6 py-4 text-sm text-slate-900">
                ${match.field.name}
            </td>
            <td class="px-6 py-4 whitespace-nowrap">
                ${match.greenScore !== null && match.blueScore !== null
                        ? `<span class="text-sm font-medium text-slate-900">${match.greenScore} - ${match.blueScore}</span>`
                        : '<span class="text-sm text-slate-500">-</span>'}
            </td>
            <td class="px-6 py-4 text-right">
                <a href="/match/${match.id}/edit" class="inline-flex items-center px-3 py-1.5 bg-blue-900 text-white text-xs rounded-lg hover:bg-blue-800 transition-colors font-medium shadow-sm">
                    <svg class="w-4 h-4 mr-1.5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path d="M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z" />
                    </svg>
                    Modifier
                </a>
            </td>`;
                    tbody.appendChild(row);
                });

                currentPage = 1;
                matchRows = Array.from(document.querySelectorAll('.match-row'));
                displayMatches();
            }

            function updateFieldsTable(fields) {
                const tbody = document.querySelector('#panel_fields table tbody');
                if (!tbody) return;

                tbody.innerHTML = '';

                if (fields.length === 0) {
                    tbody.innerHTML = `
            <tr>
                <td colspan="3" class="px-4 sm:px-6 py-4 text-center text-sm text-slate-500">
                    Aucun terrain trouv√©
                </td>
            </tr>`;
                    return;
                }

                fields.forEach(field => {
                    const row = document.createElement('tr');
                    row.className = 'hover:bg-slate-50 transition-colors';

                    row.innerHTML = `
            <td class="px-4 sm:px-6 py-3 sm:py-4">
                <div class="flex items-center">
                    <span class="text-xs sm:text-sm text-slate-600">${field.name}</span>
                </div>
            </td>
            <td class="px-4 sm:px-6 py-3 sm:py-4">
                <span class="text-xs sm:text-sm text-slate-600">${field.championship ? field.championship.name : '-'}</span>
            </td>
            <td class="px-4 sm:px-6 py-3 sm:py-4 text-xs sm:text-sm whitespace-nowrap">
                <div class="flex items-center justify-end space-x-2">
                    <form method="post" action="/field/${field.id}/delete" onsubmit="return false;" id="delete-form-${field.id}">
                        <button type="button" onclick="showDeleteConfirmation(${field.id})"
                                class="px-4 py-2 bg-red-100 text-red-700 rounded-lg hover:bg-red-200 transition-colors font-medium inline-flex items-center">
                            <svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                      d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"/>
                            </svg>
                            Supprimer
                        </button>
                    </form>
                </div>
            </td>`;
                    tbody.appendChild(row);
                });
            }

            function updateTeamsTable(teams) {
                const tbody = document.querySelector('#panel_teams table tbody');
                if (tbody) {
                    tbody.innerHTML = '';

                    if (teams.length === 0) {
                        tbody.innerHTML = `
                <tr>
                    <td colspan="3" class="px-6 py-8 text-center text-sm text-slate-500">
                        <svg class="mx-auto h-12 w-12 text-slate-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                  d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z" />
                        </svg>
                        <p class="mt-2 font-medium">Aucune √©quipe trouv√©e</p>
                    </td>
                </tr>`;
                        return;
                    }

                    teams.forEach(team => {
                        const row = document.createElement('tr');
                        row.className = 'hover:bg-slate-50 transition-colors';

                        row.innerHTML = `
                <td class="px-6 py-4 whitespace-nowrap">
                    <div class="text-sm font-medium text-slate-900">${team.name}</div>
                </td>
                <td class="px-6 py-4 whitespace-nowrap">
                    <span class="inline-flex items-center px-2.5 py-1 rounded-full text-xs font-medium bg-blue-100 text-blue-800">
                        <svg class="w-3 h-3 mr-1.5" viewBox="0 0 20 20" fill="currentColor">
                            <path d="M10 9a3 3 0 100-6 3 3 0 000 6zm-7 9a7 7 0 1114 0H3z"/>
                        </svg>
                        ${team.members.length}
                    </span>
                </td>
                <td class="px-6 py-4 whitespace-nowrap text-right text-sm font-medium">
                    <a href="/team/${team.id}/edit"
                       class="inline-flex items-center px-3 py-1.5 bg-blue-900 text-white rounded-lg hover:bg-blue-800 transition-colors font-medium shadow-sm">
                        <svg class="w-4 h-4 mr-1.5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                  d="M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z" />
                        </svg>
                        G√©rer
                    </a>
                </td>`;
                        tbody.appendChild(row);
                    });
                }

                const mobileContainer = document.querySelector('#panel_teams .sm\\:hidden');
                if (mobileContainer) {
                    mobileContainer.innerHTML = '';

                    if (teams.length === 0) {
                        mobileContainer.innerHTML = `
                <div class="p-8 text-center text-slate-500">
                    <svg class="mx-auto h-12 w-12 text-slate-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                              d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z" />
                    </svg>
                    <p class="mt-2 text-sm font-medium">Aucune √©quipe trouv√©e</p>
                </div>`;
                        return;
                    }

                    teams.forEach(team => {
                        const div = document.createElement('div');
                        div.className = 'p-4 space-y-3';

                        div.innerHTML = `
                <div class="flex justify-between items-start">
                    <div>
                        <h3 class="font-medium text-slate-900">${team.name}</h3>
                        <span class="inline-flex items-center px-2 py-1 mt-1 text-xs font-medium rounded-full bg-blue-100 text-blue-800">
                            <svg class="w-3 h-3 mr-1" viewBox="0 0 20 20" fill="currentColor">
                                <path d="M10 9a3 3 0 100-6 3 3 0 000 6zm-7 9a7 7 0 1114 0H3z"/>
                            </svg>
                            ${team.members.length} membres
                        </span>
                    </div>
                    <a href="/team/${team.id}/edit"
                       class="inline-flex items-center px-3 py-1.5 bg-blue-900 text-white text-xs rounded-lg hover:bg-blue-800 transition-colors font-medium shadow-sm">
                        <svg class="w-4 h-4 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                  d="M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z" />
                        </svg>
                        G√©rer
                    </a>
                </div>`;
                        mobileContainer.appendChild(div);
                    });
                }
            }

            const searchInput = document.getElementById('matchSearch');
            if (searchInput) {
                searchInput.addEventListener('input', (e) => {
                    const searchTerm = e.target.value.toLowerCase();
                    matchRows = Array.from(document.querySelectorAll('.match-row')).filter(row => {
                        return row.textContent.toLowerCase().includes(searchTerm);
                    });
                    currentPage = 1;
                    displayMatches();
                });
            }

            const prevButton = document.getElementById('prevPage');
            const nextButton = document.getElementById('nextPage');

            if (prevButton) {
                prevButton.addEventListener('click', () => {
                    if (currentPage > 1) {
                        currentPage--;
                        displayMatches();
                    }
                });
            }

            if (nextButton) {
                nextButton.addEventListener('click', () => {
                    const totalPages = Math.ceil(matchRows.length / MATCHES_PER_PAGE);
                    if (currentPage < totalPages) {
                        currentPage++;
                        displayMatches();
                    }
                });
            }

            displayMatches();

            window.toggleFieldModal = function () {
                const modal = document.getElementById('fieldModal');
                if (modal.classList.contains('hidden')) {
                    modal.classList.remove('hidden');
                    document.body.style.overflow = 'hidden';
                } else {
                    modal.classList.add('hidden');
                    document.body.style.overflow = 'auto';
                }
            }

            document.addEventListener('keydown', function (event) {
                if (event.key === 'Escape') {
                    const modal = document.getElementById('fieldModal');
                    if (!modal.classList.contains('hidden')) {
                        toggleFieldModal();
                    }
                }
            });

            const tabs = {
                users: document.getElementById('tab_infos'),
                championships: document.getElementById('tab_fields'),
                teams: document.getElementById('tab_teams'),
                matches: document.getElementById('tab_matches')
            };

            const panels = {
                users: document.getElementById('panel_infos'),
                championships: document.getElementById('panel_fields'),
                teams: document.getElementById('panel_teams'),
                matches: document.getElementById('panel_matches')
            };

            function activateTab(tabId) {
                console.log('Activating tab:', tabId);

                if (!tabs[tabId] || !panels[tabId]) {
                    console.error('Tab or panel not found:', tabId);
                    return;
                }

                Object.values(tabs).forEach(tab => {
                    if (tab) {
                        tab.classList.remove('text-blue-900', 'border-blue-900', 'bg-white');
                        tab.classList.add('text-slate-500', 'border-transparent');
                    }
                });

                tabs[tabId].classList.add('text-blue-900', 'border-blue-900', 'bg-white');
                tabs[tabId].classList.remove('text-slate-500', 'border-transparent');

                Object.values(panels).forEach(panel => {
                    if (panel) {
                        panel.classList.add('hidden');
                    }
                });
                panels[tabId].classList.remove('hidden');

                const subtitles = {
                    users: "{{ 'nav.manage_infos' | trans }}",
                    championships: "{{ 'nav.manage_fields' | trans }}",
                    teams: "{{ 'nav.manage_teams' | trans }}",
                    matches: "{{ 'nav.manage_matches' | trans }}"
                };

                if (subtitle) {
                    subtitle.textContent = subtitles[tabId];
                }

                localStorage.setItem('activeTab', tabId);
            }

            Object.keys(tabs).forEach(tabId => {
                if (tabs[tabId]) {
                    tabs[tabId].addEventListener('click', () => {
                        console.log('Tab clicked:', tabId);
                        activateTab(tabId);
                    });
                }
            });

            try {
                const savedTab = localStorage.getItem('activeTab') || 'infos';
                console.log('Initial tab:', savedTab);
                activateTab(savedTab);
            } catch (error) {
                console.error('Error loading initial tab:', error);
                activateTab('infos');
            }

            window.toggleActionMenu = function (menuId) {
                const menu = document.getElementById(menuId);
                const allMenus = document.querySelectorAll('[id^="action-menu-"]');

                allMenus.forEach(otherMenu => {
                    if (otherMenu.id !== menuId) {
                        otherMenu.classList.add('hidden');
                    }
                });

                menu.classList.toggle('hidden');
            }

            document.addEventListener('click', (event) => {
                if (!event.target.closest('.relative')) {
                    const allDropdowns = document.querySelectorAll('[id^="dropdown-"]');
                    const actionMenus = document.querySelectorAll('[id^="action-menu-"]');

                    allDropdowns.forEach(dropdown => {
                        dropdown.classList.add('hidden');
                    });

                    actionMenus.forEach(menu => {
                        const button = menu.previousElementSibling;
                        if (!menu.contains(event.target) && !button.contains(event.target)) {
                            menu.classList.add('hidden');
                        }
                    });
                }
            });
        });
    </script>
{% endblock %}